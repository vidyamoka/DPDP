<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>DPDP Act 2023 â€” Internal Audit Tool</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=DM+Sans:wght@400;500;600&display=swap');

  :root {
    --navy: #0f1b2d;
    --navy-mid: #1a2e4a;
    --navy-light: #243b5e;
    --saffron: #f59e0b;
    --saffron-light: #fcd34d;
    --green: #10b981;
    --green-light: #d1fae5;
    --red: #ef4444;
    --red-light: #fee2e2;
    --blue-accent: #3b82f6;
    --cream: #f8f7f2;
    --text-dark: #1e293b;
    --text-mid: #475569;
    --text-light: #94a3b8;
    --border: #e2e8f0;
    --card-bg: #ffffff;
    --shadow: 0 2px 12px rgba(15,27,45,0.08);
    --shadow-hover: 0 6px 24px rgba(15,27,45,0.14);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'DM Sans', system-ui, sans-serif;
    background: var(--cream);
    color: var(--text-dark);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  /* â”€â”€â”€ HEADER â”€â”€â”€ */
  header {
    background: linear-gradient(135deg, var(--navy) 0%, var(--navy-mid) 60%, var(--navy-light) 100%);
    padding: 18px 40px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    box-shadow: 0 4px 20px rgba(0,0,0,0.25);
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .logo-group {
    display: flex;
    align-items: center;
    gap: 16px;
  }

  .logo-svg {
    width: 54px;
    height: 54px;
    flex-shrink: 0;
  }

  .logo-text h1 {
    font-family: 'Playfair Display', serif;
    font-size: 1.45rem;
    font-weight: 700;
    color: #fff;
    letter-spacing: 0.5px;
    line-height: 1.2;
  }

  .logo-text span {
    font-size: 0.72rem;
    color: var(--saffron-light);
    text-transform: uppercase;
    letter-spacing: 2.5px;
    font-weight: 500;
  }

  .header-stats {
    display: flex;
    gap: 24px;
  }

  .stat-box {
    text-align: center;
  }

  .stat-box .num {
    font-size: 1.3rem;
    font-weight: 600;
    color: #fff;
  }

  .stat-box .lbl {
    font-size: 0.62rem;
    color: var(--text-light);
    text-transform: uppercase;
    letter-spacing: 1.5px;
  }

  .stat-box .num.green { color: var(--green); }
  .stat-box .num.saffron { color: var(--saffron); }

  /* â”€â”€â”€ PROGRESS BAR â”€â”€â”€ */
  .progress-strip {
    background: var(--navy);
    padding: 0;
    height: 6px;
  }
  .progress-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--saffron), var(--green));
    width: 0%;
    transition: width 0.5s ease;
  }

  /* â”€â”€â”€ MAIN LAYOUT â”€â”€â”€ */
  .main-wrapper {
    flex: 1;
    max-width: 1100px;
    margin: 0 auto;
    width: 100%;
    padding: 32px 24px 40px;
  }

  /* â”€â”€â”€ INTRO BANNER â”€â”€â”€ */
  .intro-banner {
    background: linear-gradient(135deg, var(--navy-mid), var(--navy-light));
    border-radius: 14px;
    padding: 26px 32px;
    margin-bottom: 28px;
    display: flex;
    align-items: flex-start;
    gap: 20px;
    box-shadow: var(--shadow);
  }

  .intro-banner .icon-circle {
    background: rgba(245,158,11,0.15);
    border: 2px solid var(--saffron);
    border-radius: 50%;
    width: 52px;
    height: 52px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    font-size: 1.4rem;
  }

  .intro-banner h2 {
    font-family: 'Playfair Display', serif;
    color: #fff;
    font-size: 1.15rem;
    margin-bottom: 6px;
  }

  .intro-banner p {
    color: var(--text-light);
    font-size: 0.82rem;
    line-height: 1.6;
  }

  /* â”€â”€â”€ CONTROLS BAR â”€â”€â”€ */
  .controls-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
    flex-wrap: wrap;
    gap: 12px;
  }

  .controls-bar .filter-group {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }

  .filter-btn {
    background: var(--card-bg);
    border: 1.5px solid var(--border);
    color: var(--text-mid);
    padding: 7px 16px;
    border-radius: 20px;
    font-size: 0.77rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    font-family: inherit;
  }

  .filter-btn:hover, .filter-btn.active {
    background: var(--navy);
    color: #fff;
    border-color: var(--navy);
  }

  .btn-reset {
    background: var(--red-light);
    color: var(--red);
    border: 1.5px solid var(--red);
    padding: 7px 18px;
    border-radius: 20px;
    font-size: 0.77rem;
    font-weight: 600;
    cursor: pointer;
    font-family: inherit;
    transition: all 0.2s;
  }

  .btn-reset:hover {
    background: var(--red);
    color: #fff;
  }

  .btn-export {
    background: var(--saffron);
    color: var(--navy);
    border: none;
    padding: 7px 18px;
    border-radius: 20px;
    font-size: 0.77rem;
    font-weight: 600;
    cursor: pointer;
    font-family: inherit;
    transition: all 0.2s;
  }

  .btn-export:hover {
    background: var(--saffron-light);
  }

  .action-btns { display: flex; gap: 8px; }

  /* â”€â”€â”€ CHAPTER CARD â”€â”€â”€ */
  .chapter-card {
    background: var(--card-bg);
    border-radius: 12px;
    box-shadow: var(--shadow);
    margin-bottom: 16px;
    border: 1.5px solid var(--border);
    overflow: hidden;
    transition: box-shadow 0.25s;
  }

  .chapter-card:hover { box-shadow: var(--shadow-hover); }

  .chapter-header {
    display: flex;
    align-items: center;
    padding: 16px 22px;
    cursor: pointer;
    user-select: none;
    gap: 14px;
    background: #fafafa;
    border-bottom: 1.5px solid var(--border);
  }

  .chapter-header:hover { background: #f4f6f8; }

  .ch-checkbox-wrap {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex-shrink: 0;
  }

  .ch-checkbox {
    width: 22px;
    height: 22px;
    border: 2px solid var(--border);
    border-radius: 5px;
    background: #fff;
    cursor: pointer;
    appearance: none;
    -webkit-appearance: none;
    transition: all 0.2s;
    position: relative;
  }

  .ch-checkbox:checked {
    background: var(--green);
    border-color: var(--green);
  }

  .ch-checkbox:checked::after {
    content: 'âœ“';
    color: #fff;
    font-size: 14px;
    position: absolute;
    top: 1px;
    left: 3px;
    font-weight: 700;
  }

  .ch-progress-mini {
    font-size: 0.58rem;
    color: var(--text-light);
    margin-top: 3px;
    white-space: nowrap;
  }

  .ch-badge {
    background: var(--navy);
    color: #fff;
    font-size: 0.68rem;
    font-weight: 600;
    padding: 3px 10px;
    border-radius: 12px;
    white-space: nowrap;
    letter-spacing: 0.5px;
  }

  .ch-title-wrap { flex: 1; min-width: 0; }

  .ch-title-wrap h3 {
    font-family: 'Playfair Display', serif;
    font-size: 1rem;
    color: var(--text-dark);
    line-height: 1.3;
  }

  .ch-title-wrap p {
    font-size: 0.73rem;
    color: var(--text-light);
    margin-top: 2px;
  }

  .ch-progress-bar {
    flex-shrink: 0;
    width: 80px;
    text-align: right;
  }

  .ch-progress-bar .pbar-bg {
    height: 5px;
    background: var(--border);
    border-radius: 3px;
    overflow: hidden;
    margin-top: 4px;
  }

  .ch-progress-bar .pbar-fill {
    height: 100%;
    background: var(--green);
    border-radius: 3px;
    width: 0%;
    transition: width 0.4s ease;
  }

  .ch-progress-bar .pbar-txt {
    font-size: 0.65rem;
    color: var(--text-light);
    font-weight: 600;
  }

  .ch-chevron {
    font-size: 0.75rem;
    color: var(--text-light);
    transition: transform 0.3s;
    flex-shrink: 0;
  }

  .chapter-card.open .ch-chevron { transform: rotate(180deg); }

  /* â”€â”€â”€ SECTION BODY â”€â”€â”€ */
  .chapter-body {
    display: none;
    padding: 0;
  }

  .chapter-card.open .chapter-body { display: block; }

  .section-row {
    display: flex;
    align-items: flex-start;
    padding: 14px 22px 14px 44px;
    gap: 14px;
    border-bottom: 1px solid #f1f3f6;
    transition: background 0.15s;
  }

  .section-row:last-child { border-bottom: none; }
  .section-row:hover { background: #fafbfd; }

  .section-row .sec-checkbox {
    width: 19px;
    height: 19px;
    border: 2px solid var(--border);
    border-radius: 4px;
    background: #fff;
    cursor: pointer;
    appearance: none;
    -webkit-appearance: none;
    transition: all 0.2s;
    flex-shrink: 0;
    margin-top: 2px;
    position: relative;
  }

  .section-row .sec-checkbox:checked {
    background: var(--green);
    border-color: var(--green);
  }

  .section-row .sec-checkbox:checked::after {
    content: 'âœ“';
    color: #fff;
    font-size: 11px;
    position: absolute;
    top: 1px;
    left: 2.5px;
    font-weight: 700;
  }

  .sec-content { flex: 1; min-width: 0; }

  .sec-content .sec-head {
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
  }

  .sec-content .sec-head h4 {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-dark);
  }

  .sec-content .sec-head .sec-num {
    font-size: 0.7rem;
    font-weight: 600;
    color: var(--saffron);
    background: #fef3c7;
    padding: 2px 8px;
    border-radius: 8px;
  }

  .sec-content .sec-head .sec-chevron {
    font-size: 0.6rem;
    color: var(--text-light);
    transition: transform 0.25s;
  }

  .section-row.open .sec-chevron { transform: rotate(180deg); }

  .sec-detail {
    display: none;
    margin-top: 10px;
    padding: 14px 16px;
    background: #f8fafc;
    border-radius: 8px;
    border: 1px solid #eef1f5;
  }

  .section-row.open .sec-detail { display: block; }

  .sec-detail .detail-label {
    font-size: 0.68rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1.2px;
    color: var(--saffron);
    margin-bottom: 6px;
    margin-top: 12px;
  }

  .sec-detail .detail-label:first-child { margin-top: 0; }

  .sec-detail .detail-text {
    font-size: 0.78rem;
    color: var(--text-mid);
    line-height: 1.65;
  }

  .audit-step {
    display: flex;
    gap: 10px;
    align-items: flex-start;
    margin-bottom: 8px;
  }

  .audit-step .step-num {
    background: var(--navy);
    color: #fff;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.68rem;
    font-weight: 700;
    flex-shrink: 0;
  }

  .audit-step .step-txt {
    font-size: 0.78rem;
    color: var(--text-mid);
    line-height: 1.5;
    padding-top: 3px;
  }

  .risk-tag {
    display: inline-block;
    font-size: 0.65rem;
    font-weight: 600;
    padding: 2px 9px;
    border-radius: 10px;
    margin-left: 8px;
  }

  .risk-high { background: var(--red-light); color: var(--red); }
  .risk-medium { background: #fef3c7; color: #b45309; }
  .risk-low { background: var(--green-light); color: #047857; }

  /* â”€â”€â”€ FOOTER â”€â”€â”€ */
  footer {
    background: var(--navy);
    padding: 24px 40px;
    margin-top: auto;
  }

  .footer-inner {
    max-width: 1100px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 12px;
  }

  .footer-left {
    display: flex;
    align-items: center;
    gap: 14px;
  }

  .footer-logo {
    width: 28px;
    height: 28px;
    opacity: 0.7;
  }

  .footer-copy {
    font-size: 0.7rem;
    color: var(--text-light);
    line-height: 1.5;
  }

  .footer-copy strong { color: rgba(255,255,255,0.7); }

  .footer-right {
    font-size: 0.65rem;
    color: var(--text-light);
    text-align: right;
    line-height: 1.6;
  }

  .footer-right a {
    color: var(--saffron-light);
    text-decoration: none;
  }

  /* â”€â”€â”€ PRINT / EXPORT MODAL â”€â”€â”€ */
  .modal-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.45);
    z-index: 500;
    align-items: center;
    justify-content: center;
  }

  .modal-overlay.show { display: flex; }

  .modal {
    background: #fff;
    border-radius: 14px;
    width: 500px;
    max-width: 92vw;
    padding: 30px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  }

  .modal h3 {
    font-family: 'Playfair Display', serif;
    font-size: 1.1rem;
    margin-bottom: 8px;
    color: var(--text-dark);
  }

  .modal p {
    font-size: 0.78rem;
    color: var(--text-mid);
    margin-bottom: 20px;
    line-height: 1.5;
  }

  .modal-btns { display: flex; gap: 10px; justify-content: flex-end; }

  .modal-btns button {
    padding: 8px 20px;
    border-radius: 8px;
    font-size: 0.78rem;
    font-weight: 600;
    cursor: pointer;
    font-family: inherit;
    border: none;
    transition: all 0.2s;
  }

  .btn-cancel { background: var(--border); color: var(--text-mid); }
  .btn-cancel:hover { background: #dde2e8; }
  .btn-confirm { background: var(--navy); color: #fff; }
  .btn-confirm:hover { background: var(--navy-mid); }

  /* â”€â”€â”€ SEARCH â”€â”€â”€ */
  .search-wrap {
    position: relative;
    width: 240px;
  }

  .search-wrap input {
    width: 100%;
    padding: 7px 14px 7px 34px;
    border: 1.5px solid var(--border);
    border-radius: 20px;
    font-size: 0.77rem;
    font-family: inherit;
    background: var(--card-bg);
    color: var(--text-dark);
    outline: none;
    transition: border-color 0.2s;
  }

  .search-wrap input:focus { border-color: var(--navy); }

  .search-wrap .search-icon {
    position: absolute;
    left: 11px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-light);
    font-size: 0.8rem;
  }

  /* Scrollbar */
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

  @media (max-width: 680px) {
    header { padding: 14px 18px; }
    .header-stats { display: none; }
    .main-wrapper { padding: 20px 12px 32px; }
    .section-row { padding-left: 22px; }
    footer { padding: 18px 20px; }
    .footer-inner { flex-direction: column; align-items: flex-start; }
    .search-wrap { width: 100%; }
  }
</style>
</head>
<body>

<!-- â”€â”€â”€ HEADER â”€â”€â”€ -->
<header>
  <div class="logo-group">
    <!-- SVG Logo: Shield with data nodes -->
    <svg class="logo-svg" viewBox="0 0 54 54" fill="none" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="shieldGrad" x1="0" y1="0" x2="54" y2="54">
          <stop offset="0%" stop-color="#f59e0b"/>
          <stop offset="100%" stop-color="#fcd34d"/>
        </linearGradient>
      </defs>
      <!-- Shield shape -->
      <path d="M27 3L6 13v18c0 11.5 9 22 21 25 12-3 21-13.5 21-25V13L27 3z" fill="none" stroke="url(#shieldGrad)" stroke-width="2.5" stroke-linejoin="round"/>
      <!-- Inner lock body -->
      <rect x="20" y="27" width="14" height="11" rx="2.5" fill="#f59e0b"/>
      <!-- Lock shackle -->
      <path d="M22 27v-4a5 5 0 0110 0v4" fill="none" stroke="#f59e0b" stroke-width="2.5" stroke-linecap="round"/>
      <!-- Keyhole dot -->
      <circle cx="27" cy="33" r="1.6" fill="#0f1b2d"/>
      <!-- Accent dots -->
      <circle cx="12" cy="17" r="2" fill="#3b82f6" opacity="0.7"/>
      <circle cx="42" cy="17" r="2" fill="#10b981" opacity="0.7"/>
      <circle cx="27" cy="8" r="1.5" fill="#fcd34d" opacity="0.9"/>
    </svg>
    <div class="logo-text">
      <h1>DataShield Audit</h1>
      <span>DPDP Act 2023 â€” Internal Compliance</span>
    </div>
  </div>
  <div class="header-stats">
    <div class="stat-box">
      <div class="num" id="totalSections">44</div>
      <div class="lbl">Sections</div>
    </div>
    <div class="stat-box">
      <div class="num green" id="completedCount">0</div>
      <div class="lbl">Completed</div>
    </div>
    <div class="stat-box">
      <div class="num saffron" id="pendingCount">44</div>
      <div class="lbl">Pending</div>
    </div>
  </div>
</header>

<!-- Thin progress strip -->
<div class="progress-strip"><div class="progress-bar-fill" id="globalProgressBar"></div></div>

<!-- â”€â”€â”€ MAIN â”€â”€â”€ -->
<div class="main-wrapper">

  <!-- Intro -->
  <div class="intro-banner">
    <div class="icon-circle">ğŸ“‹</div>
    <div>
      <h2>DPDP Act 2023 â€” Internal Audit Checklist</h2>
      <p>
        This tool covers all 44 sections across 9 chapters of the Digital Personal Data Protection Act, 2023.
        Expand each chapter, review the audit procedure, and tick off completed items. Track your overall compliance readiness in real time.
        Full compliance deadline: <strong style="color:#fcd34d;">13 May 2027</strong>.
      </p>
    </div>
  </div>

  <!-- Controls -->
  <div class="controls-bar">
    <div class="filter-group">
      <button class="filter-btn active" onclick="filterChapters('all', this)">All Chapters</button>
      <button class="filter-btn" onclick="filterChapters('pending', this)">Pending</button>
      <button class="filter-btn" onclick="filterChapters('done', this)">Completed</button>
    </div>
    <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
      <div class="search-wrap">
        <span class="search-icon">ğŸ”</span>
        <input type="text" id="searchInput" placeholder="Search sectionsâ€¦" oninput="searchSections()" />
      </div>
      <div class="action-btns">
        <button class="btn-export" onclick="openModal()">â¬‡ Export Report</button>
        <button class="btn-reset" onclick="confirmReset()">â†º Reset All</button>
      </div>
    </div>
  </div>

  <!-- Cards injected by JS -->
  <div id="chaptersContainer"></div>
</div>

<!-- â”€â”€â”€ FOOTER â”€â”€â”€ -->
<footer>
  <div class="footer-inner">
    <div class="footer-left">
      <svg class="footer-logo" viewBox="0 0 54 54" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M27 3L6 13v18c0 11.5 9 22 21 25 12-3 21-13.5 21-25V13L27 3z" fill="none" stroke="#f59e0b" stroke-width="3" stroke-linejoin="round" opacity="0.6"/>
        <rect x="20" y="27" width="14" height="11" rx="2.5" fill="#f59e0b" opacity="0.6"/>
        <path d="M22 27v-4a5 5 0 0110 0v4" fill="none" stroke="#f59e0b" stroke-width="2.5" stroke-linecap="round" opacity="0.6"/>
      </svg>
      <div class="footer-copy">
        <strong>Â© 2025 DataShield Audit Tool</strong><br/>
        All rights reserved. For internal use only. Not for distribution.
      </div>
    </div>
    <div class="footer-right">
      Built for compliance with the <strong style="color:rgba(255,255,255,0.6);">Digital Personal Data Protection Act, 2023</strong><br/>
      Reference: <a href="#">MeitY Gazette Notification</a> &nbsp;|&nbsp; Act No. 22 of 2023<br/>
      <span style="opacity:0.5;">Version 1.0 &nbsp;|&nbsp; January 2025</span>
    </div>
  </div>
</footer>

<!-- â”€â”€â”€ MODAL â”€â”€â”€ -->
<div class="modal-overlay" id="modalOverlay">
  <div class="modal" id="modalBox">
    <h3 id="modalTitle">Export Audit Report</h3>
    <p id="modalDesc">This will generate a printable summary of your current audit progress across all 44 sections. Open your browser's print dialog to save as PDF.</p>
    <div class="modal-btns">
      <button class="btn-cancel" onclick="closeModal()">Cancel</button>
      <button class="btn-confirm" id="modalConfirmBtn" onclick="closeModal(); window.print();">Print / Save PDF</button>
    </div>
  </div>
</div>


<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DATA â€” All 44 sections of DPDP Act 2023, 9 Chapters
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CHAPTERS = [
  {
    id: "ch1",
    title: "Chapter I â€” Preliminary",
    sections: [
      {
        num: "1", title: "Short Title and Commencement",
        risk: "low",
        desc: "Defines the Act's name and provides that it comes into force on dates notified by the Central Government in phases.",
        auditSteps: [
          "Verify the organisation is aware of the phased enforcement timeline notified by the Central Government.",
          "Confirm internal legal/compliance teams have mapped which sections are currently in force vs. upcoming.",
          "Cross-reference with the official MeitY Gazette notification dates."
        ]
      },
      {
        num: "2", title: "Definitions",
        risk: "medium",
        desc: "Establishes key terms: Personal Data, Data Fiduciary, Data Principal, Data Processor, Consent, Legitimate Use, etc.",
        auditSteps: [
          "Audit whether the organisation's internal data glossary aligns with the Act's statutory definitions.",
          "Verify that 'Data Fiduciary' and 'Data Principal' roles are correctly identified across all business units.",
          "Check that 'Personal Data' classification is consistently applied in data inventories."
        ]
      }
    ]
  },
  {
    id: "ch2",
    title: "Chapter II â€” Obligations of Data Fiduciary",
    sections: [
      {
        num: "3", title: "Application of the Act",
        risk: "high",
        desc: "Defines territorial and extra-territorial scope: applies to digital personal data collected in India or processed outside India for offering goods/services to Indian Data Principals.",
        auditSteps: [
          "Map all data flows â€” identify personal data processed within and outside India.",
          "Confirm cross-border processing activities are documented and linked to offering goods/services in India.",
          "Validate that personal/domestic-use exclusions are correctly applied."
        ]
      },
      {
        num: "4", title: "Processing of Personal Data",
        risk: "high",
        desc: "Personal data shall be processed only for a lawful purpose for which the Data Principal has given consent or for a Legitimate Use.",
        auditSteps: [
          "Audit all processing activities against documented lawful purposes.",
          "Verify each processing activity has a corresponding valid consent record or a documented legitimate-use basis.",
          "Review data processing registers for completeness and accuracy."
        ]
      },
      {
        num: "5", title: "Notice to Data Principal",
        risk: "high",
        desc: "Before or at the time of collecting consent, the Data Fiduciary must provide a clear, concise notice of what data is collected and for what purpose.",
        auditSteps: [
          "Review all consent collection touchpoints (web forms, apps, SMS, etc.) for presence of privacy notices.",
          "Validate that notices are available in at least one of the 22 scheduled languages.",
          "Test notice clarity â€” ensure a lay user can understand the purpose and scope of data processing."
        ]
      },
      {
        num: "6", title: "Consent",
        risk: "high",
        desc: "Consent must be free, specific, informed, and unambiguous. It can be withdrawn at any time. Consent for children requires parental/guardian verification.",
        auditSteps: [
          "Audit consent mechanisms for clarity and granularity (specific, informed, unambiguous).",
          "Verify a functional consent-withdrawal mechanism exists and is easily accessible.",
          "Check child-data processes â€” confirm parental/guardian consent verification is in place for users under 18.",
          "Review Consent Manager integration if applicable."
        ]
      },
      {
        num: "7", title: "Legitimate Uses",
        risk: "medium",
        desc: "Lists specific scenarios where personal data may be processed without consent â€” e.g., employment, medical emergencies, legal compliance, government services.",
        auditSteps: [
          "Identify all processing activities relying on legitimate-use grounds.",
          "Map each legitimate-use claim to the specific enumerated purpose in the Act.",
          "Ensure proper documentation exists for each legitimate-use invocation."
        ]
      },
      {
        num: "8", title: "Obligations of Data Fiduciary",
        risk: "high",
        desc: "Core obligations: ensure accuracy, implement reasonable security measures, notify breaches, and honour Data Principal rights within reasonable timelines.",
        auditSteps: [
          "Audit data accuracy practices â€” validate update/correction workflows.",
          "Review security controls: encryption, access controls, penetration testing, incident response.",
          "Confirm breach notification procedures exist and include reporting to the Data Protection Board.",
          "Verify timelines for responding to Data Principal requests are defined and tracked."
        ]
      },
      {
        num: "9", title: "Duty to Erase Personal Data",
        risk: "medium",
        desc: "Data Fiduciaries must erase personal data when it is no longer needed for the purpose it was collected, or when consent is withdrawn.",
        auditSteps: [
          "Audit data retention schedules across all systems and databases.",
          "Verify automated or manual erasure workflows are operational.",
          "Test the erasure mechanism â€” confirm data is actually deleted (including backups, logs).",
          "Cross-check with Data Processors to ensure downstream erasure compliance."
        ]
      },
      {
        num: "10", title: "Significant Data Fiduciary",
        risk: "high",
        desc: "Central Government may designate certain Data Fiduciaries as 'Significant' based on volume, sensitivity, and risk. Such entities face additional obligations: DPO appointment, data audits, and DPIA.",
        auditSteps: [
          "Assess whether the organisation meets criteria for Significant Data Fiduciary designation.",
          "If designated (or likely), confirm a Data Protection Officer (DPO) based in India is appointed.",
          "Verify an independent data audit is conducted periodically.",
          "Review whether a Data Protection Impact Assessment (DPIA) has been performed."
        ]
      }
    ]
  },
  {
    id: "ch3",
    title: "Chapter III â€” Rights & Duties of Data Principal",
    sections: [
      {
        num: "11", title: "Right to Access Information",
        risk: "medium",
        desc: "Data Principals have the right to obtain a summary of personal data processed, the identities of Data Fiduciaries and Processors, and details of processing activities.",
        auditSteps: [
          "Verify a mechanism exists for Data Principals to request access to their data.",
          "Test the request-to-response workflow end-to-end.",
          "Confirm the response includes all mandatory elements: data summary, fiduciary identities, processing details."
        ]
      },
      {
        num: "12", title: "Right to Correction and Erasure",
        risk: "medium",
        desc: "Data Principals may request correction of inaccurate or incomplete personal data and erasure of their data, subject to legal retention requirements.",
        auditSteps: [
          "Audit the correction-request workflow for completeness.",
          "Verify erasure requests are actioned within a reasonable timeframe.",
          "Ensure legal-hold and retention exceptions are properly documented and communicated."
        ]
      },
      {
        num: "13", title: "Right to Nominate",
        risk: "low",
        desc: "A Data Principal may nominate another individual to exercise their rights in case of death or incapacity.",
        auditSteps: [
          "Check whether a nomination mechanism is available within the organisation's data services.",
          "Verify the nomination process is documented and legally sound.",
          "Confirm the nominated person can actually exercise rights upon the triggering event."
        ]
      },
      {
        num: "14", title: "Grievance Redressal",
        risk: "medium",
        desc: "Data Fiduciaries must provide an accessible grievance redressal mechanism. Data Principals must exhaust this before approaching the Data Protection Board.",
        auditSteps: [
          "Audit the grievance redressal portal/process for accessibility and responsiveness.",
          "Verify response timelines are defined and met.",
          "Check that the mechanism is prominently displayed in all privacy notices and communications."
        ]
      },
      {
        num: "15", title: "Duties of Data Principal",
        risk: "low",
        desc: "Data Principals must not supply false or fabricated personal data, and must not impersonate another person when giving consent.",
        auditSteps: [
          "Review terms-of-service and onboarding flows to ensure these duties are clearly communicated.",
          "Confirm that fraud-detection measures are in place for identity verification at consent stage."
        ]
      }
    ]
  },
  {
    id: "ch4",
    title: "Chapter IV â€” Special Provisions",
    sections: [
      {
        num: "16", title: "Processing of Children's Personal Data",
        risk: "high",
        desc: "Children (under 18) require verifiable parental/guardian consent. Central Government may exempt certain Data Fiduciaries if they demonstrate adequate safeguards for children's data.",
        auditSteps: [
          "Map all services or products accessible to users under 18.",
          "Verify age-verification mechanisms are in place before data collection.",
          "Confirm parental/guardian consent workflows are robust and verifiable.",
          "Document any exemption application if applicable."
        ]
      },
      {
        num: "17", title: "Exemptions",
        risk: "medium",
        desc: "Certain processing activities are exempt from Act obligations â€” including national security, public order, research, and startup exemptions notified by the Central Government.",
        auditSteps: [
          "Identify any processing activities that may qualify for an exemption.",
          "Confirm the exemption has been formally notified by the Central Government.",
          "Document the basis for claiming each exemption and maintain audit trail."
        ]
      }
    ]
  },
  {
    id: "ch5",
    title: "Chapter V â€” Data Protection Board of India",
    sections: [
      {
        num: "18", title: "Establishment of the Board",
        risk: "low",
        desc: "Establishes the Data Protection Board of India as the statutory adjudicatory body for resolving disputes related to personal data breaches and Act violations.",
        auditSteps: [
          "Confirm internal awareness of the Board's existence and its role.",
          "Ensure the organisation's breach notification procedures include reporting to the Board.",
          "Monitor Board notifications and guidance for compliance updates."
        ]
      },
      {
        num: "19", title: "Composition of the Board",
        risk: "low",
        desc: "The Board comprises a Chairperson and members appointed by the Central Government; tenure is two years with possibility of reappointment.",
        auditSteps: [
          "No direct organisational obligation â€” monitor for any changes in Board composition that affect regulatory stance."
        ]
      },
      {
        num: "20", title: "Qualification and Conditions of Service",
        risk: "low",
        desc: "Prescribes qualifications, service conditions, and removal grounds for Board members.",
        auditSteps: [
          "No direct organisational obligation â€” track for governance changes."
        ]
      },
      {
        num: "21", title: "Meetings of the Board",
        risk: "low",
        desc: "Governs how and when the Board meets and conducts its proceedings.",
        auditSteps: [
          "No direct organisational obligation â€” monitor Board meeting outcomes for compliance implications."
        ]
      },
      {
        num: "22", title: "Powers and Duties of the Board",
        risk: "medium",
        desc: "The Board can investigate complaints, summon information, inspect records, and direct remedial/mitigation measures in case of breaches.",
        auditSteps: [
          "Ensure the organisation is prepared to respond to Board summons or information requests.",
          "Maintain a readiness plan for Board inspections â€” data access logs, records, and remediation evidence."
        ]
      },
      {
        num: "23", title: "Adjudication of Complaints",
        risk: "medium",
        desc: "Data Principals may file complaints with the Board only after exhausting the grievance redressal mechanism of the Data Fiduciary.",
        auditSteps: [
          "Audit the completeness and effectiveness of the internal grievance mechanism to minimise Board escalations.",
          "Track any complaints filed with the Board and their outcomes."
        ]
      },
      {
        num: "24", title: "Powers regarding Breach",
        risk: "high",
        desc: "Upon receipt of a breach intimation, the Board may direct urgent remedial or mitigation measures and investigate the root cause.",
        auditSteps: [
          "Test the breach notification workflow â€” simulate a breach scenario end-to-end.",
          "Ensure incident response plans include Board communication protocols.",
          "Validate that remedial measures can be executed promptly post-breach."
        ]
      },
      {
        num: "25", title: "Voluntary Undertaking",
        risk: "low",
        desc: "A Data Fiduciary may voluntarily offer an undertaking to the Board to take specific actions; violation of such undertaking triggers penalties.",
        auditSteps: [
          "Review any voluntary undertakings made to the Board.",
          "Monitor compliance with each undertaking term and maintain evidence."
        ]
      },
      {
        num: "26", title: "Penalty Determination",
        risk: "high",
        desc: "The Board determines penalties based on factors including gravity, repetitiveness, and nature of the breach. Maximum penalty is â‚¹250 crore.",
        auditSteps: [
          "Understand the penalty framework and factors that influence quantum.",
          "Conduct risk assessment of potential penalty exposure based on current compliance gaps.",
          "Prioritise remediation of high-risk areas to minimise penalty exposure."
        ]
      }
    ]
  },
  {
    id: "ch6",
    title: "Chapter VI â€” Powers & Procedures of the Board",
    sections: [
      {
        num: "27", title: "Powers of the Board",
        risk: "medium",
        desc: "Detailed powers including directing compliance, ordering data erasure, and imposing interim measures during investigations.",
        auditSteps: [
          "Ensure the organisation has documented procedures for responding to Board orders.",
          "Maintain legal counsel availability for urgent Board interactions."
        ]
      },
      {
        num: "28", title: "Procedure for Adjudication",
        risk: "low",
        desc: "Prescribes the procedural framework for how the Board hears and decides complaints.",
        auditSteps: [
          "Familiarise internal teams with the Board's adjudication procedure for preparedness."
        ]
      }
    ]
  },
  {
    id: "ch7",
    title: "Chapter VII â€” Appeals & Alternate Dispute Resolution",
    sections: [
      {
        num: "29", title: "Appeals to High Court",
        risk: "medium",
        desc: "Any person aggrieved by a Board order may appeal to the High Court within the prescribed timeframe.",
        auditSteps: [
          "Confirm the organisation's legal team tracks all Board orders and assesses appeal viability.",
          "Document timelines for appeal filing."
        ]
      },
      {
        num: "30", title: "Alternate Dispute Resolution",
        risk: "low",
        desc: "The Board may refer disputes to mediation or other ADR mechanisms before formal adjudication.",
        auditSteps: [
          "Assess whether ADR might be a preferable resolution path for any pending disputes.",
          "Include ADR preparedness in the legal team's training."
        ]
      }
    ]
  },
  {
    id: "ch8",
    title: "Chapter VIII â€” Penalties & Adjudication",
    sections: [
      {
        num: "31", title: "Penalties â€” Schedule",
        risk: "high",
        desc: "Prescribes the penalty schedule: up to â‚¹250 crore for security failures, â‚¹200 crore for breach non-reporting or children's data violations, â‚¹50 crore for other non-compliance.",
        auditSteps: [
          "Map all penalty categories to relevant organisational processes.",
          "Conduct a gap analysis to identify which penalty-triggering areas have the highest risk.",
          "Prioritise controls for security safeguards, breach reporting, and children's data."
        ]
      },
      {
        num: "32", title: "Adjudication of Penalties",
        risk: "medium",
        desc: "The Board may impose penalties after giving the Data Fiduciary a reasonable opportunity to be heard.",
        auditSteps: [
          "Ensure the organisation can present a well-documented defence if a penalty proceeding is initiated.",
          "Maintain records of all compliance actions taken as evidence."
        ]
      },
      {
        num: "33", title: "Recovery of Penalties",
        risk: "medium",
        desc: "Penalties imposed by the Board are recoverable as arrears of land revenue through the prescribed authority.",
        auditSteps: [
          "Include potential penalty costs in the organisation's financial risk assessment.",
          "Engage finance and treasury teams in understanding penalty implications."
        ]
      },
      {
        num: "34", title: "Compensation",
        risk: "high",
        desc: "Data Principals may seek compensation for harm suffered due to breach of the Act. The Board determines the quantum based on harm, gravity, and circumstances.",
        auditSteps: [
          "Assess liability exposure for potential compensation claims.",
          "Implement measures to minimise harm in case of any breach.",
          "Ensure insurance coverage is reviewed with awareness of DPDP compensation provisions."
        ]
      }
    ]
  },
  {
    id: "ch9",
    title: "Chapter IX â€” Miscellaneous",
    sections: [
      {
        num: "35", title: "Cross-Border Transfer of Personal Data",
        risk: "high",
        desc: "Data may be transferred abroad unless the Central Government blacklists a specific country. Higher-protection sectoral laws prevail where applicable.",
        auditSteps: [
          "Map all cross-border data transfers and their destination countries.",
          "Monitor the Central Government's blacklisted-country notifications.",
          "Verify compliance with any stricter sectoral regulations applicable to specific data transfers."
        ]
      },
      {
        num: "36", title: "Obligations of Data Processor",
        risk: "medium",
        desc: "Data Processors must process data only as directed by the Data Fiduciary and are bound by the same security and confidentiality obligations.",
        auditSteps: [
          "Audit all third-party Data Processor contracts for DPDP compliance clauses.",
          "Verify Processors implement equivalent security safeguards.",
          "Conduct periodic due-diligence assessments of critical Processors."
        ]
      },
      {
        num: "37", title: "Consent Manager",
        risk: "medium",
        desc: "A Consent Manager is a registered entity that acts as a single point of contact for a Data Principal to manage consent across multiple Data Fiduciaries.",
        auditSteps: [
          "Assess whether the organisation should integrate with a registered Consent Manager.",
          "If applicable, verify the Consent Manager's registration and operational compliance."
        ]
      },
      {
        num: "38", title: "Deemed Consent / Legitimate Use Details",
        risk: "medium",
        desc: "Provides further operational detail on how Legitimate Uses are documented and applied in practice.",
        auditSteps: [
          "Ensure all Legitimate Use invocations are documented with specific references to the enumerated grounds.",
          "Audit documentation completeness for all non-consent-based processing."
        ]
      },
      {
        num: "39", title: "Liability of Data Fiduciary for Processor Actions",
        risk: "high",
        desc: "The Data Fiduciary remains liable for the actions of its Data Processors unless the Processor has acted contrary to the Fiduciary's instructions.",
        auditSteps: [
          "Review all Processor agreements to ensure clear instruction protocols.",
          "Implement monitoring mechanisms for Processor compliance.",
          "Maintain evidence of instructions given to Processors to establish due diligence."
        ]
      },
      {
        num: "40", title: "Power to Make Rules",
        risk: "low",
        desc: "Empowers the Central Government to frame rules under the Act â€” these are the DPDP Rules 2025, which operationalise the Act's provisions.",
        auditSteps: [
          "Monitor DPDP Rules 2025 notifications for new obligations.",
          "Update internal compliance frameworks as new rules come into force."
        ]
      },
      {
        num: "41", title: "Laying of Rules Before Parliament",
        risk: "low",
        desc: "Rules framed under the Act are to be laid before Parliament for scrutiny.",
        auditSteps: [
          "No direct organisational obligation â€” monitor parliamentary discussions for policy direction."
        ]
      },
      {
        num: "42", title: "Penalties for Obstruction",
        risk: "low",
        desc: "Penalty for willfully obstructing any officer of the Board in the exercise of their powers or duties.",
        auditSteps: [
          "Ensure all staff are trained on cooperating with Board officers during inspections.",
          "Maintain a clear internal protocol for handling Board visits."
        ]
      },
      {
        num: "43", title: "Amendment of Act",
        risk: "low",
        desc: "Provides that the Act may be amended by Parliament as needed.",
        auditSteps: [
          "Monitor legislative amendments and update compliance plans accordingly."
        ]
      },
      {
        num: "44", title: "Repeal and Savings",
        risk: "low",
        desc: "Upon full enforcement, Section 43A of the IT Act 2000 and associated IT Rules 2011 are repealed. Ongoing proceedings under repealed provisions continue under the new Act.",
        auditSteps: [
          "Verify that legacy IT Act 43A compliance processes are transitioned to DPDP Act frameworks.",
          "Confirm all pending proceedings under old rules are tracked and handled under the new Act."
        ]
      }
    ]
  }
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let checkedSections = {};  // key: "ch_id-sec_num", value: boolean
let openChapters = {};
let openSections = {};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  RENDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function render() {
  const container = document.getElementById('chaptersContainer');
  container.innerHTML = '';

  CHAPTERS.forEach(ch => {
    const card = document.createElement('div');
    card.className = 'chapter-card' + (openChapters[ch.id] ? ' open' : '');
    card.id = ch.id;

    const totalSecs = ch.sections.length;
    const doneCount = ch.sections.filter(s => checkedSections[ch.id + '-' + s.num]).length;
    const pct = totalSecs > 0 ? Math.round((doneCount / totalSecs) * 100) : 0;
    const allDone = doneCount === totalSecs;

    card.innerHTML = `
      <div class="chapter-header" onclick="toggleChapter('${ch.id}')">
        <div class="ch-checkbox-wrap" onclick="event.stopPropagation(); toggleChapterAll('${ch.id}')">
          <input type="checkbox" class="ch-checkbox" id="chk-${ch.id}" ${allDone ? 'checked' : ''} />
          <span class="ch-progress-mini">${doneCount}/${totalSecs}</span>
        </div>
        <span class="ch-badge">Ch ${ch.id.replace('ch','')}</span>
        <div class="ch-title-wrap">
          <h3>${ch.title}</h3>
          <p>Sections ${ch.sections[0].num} â€“ ${ch.sections[ch.sections.length-1].num} &nbsp;|&nbsp; ${totalSecs} audit item${totalSecs > 1 ? 's' : ''}</p>
        </div>
        <div class="ch-progress-bar">
          <div class="pbar-txt">${pct}%</div>
          <div class="pbar-bg"><div class="pbar-fill" style="width:${pct}%"></div></div>
        </div>
        <span class="ch-chevron">â–¼</span>
      </div>
      <div class="chapter-body" id="body-${ch.id}">
        ${ch.sections.map(s => renderSection(ch.id, s)).join('')}
      </div>
    `;
    container.appendChild(card);
  });

  updateHeaderStats();
}

function renderSection(chId, s) {
  const key = chId + '-' + s.num;
  const checked = checkedSections[key] || false;
  const isOpen = openSections[key] || false;
  const riskClass = 'risk-' + s.risk;
  const riskLabel = s.risk.charAt(0).toUpperCase() + s.risk.slice(1);

  return `
    <div class="section-row ${isOpen ? 'open' : ''}" id="sec-${key}">
      <input type="checkbox" class="sec-checkbox" ${checked ? 'checked' : ''} onchange="toggleSection('${key}')" />
      <div class="sec-content">
        <div class="sec-head" onclick="toggleSectionDetail('${key}')">
          <span class="sec-num">Â§ ${s.num}</span>
          <h4>${s.title}</h4>
          <span class="risk-tag ${riskClass}">${riskLabel} Risk</span>
          <span class="sec-chevron">â–¼</span>
        </div>
        <div class="sec-detail" id="detail-${key}">
          <div class="detail-label">ğŸ“„ Section Overview</div>
          <div class="detail-text">${s.desc}</div>
          <div class="detail-label">âœ… Audit Procedure</div>
          <div class="detail-text">
            ${s.auditSteps.map((step, i) => `
              <div class="audit-step">
                <div class="step-num">${i+1}</div>
                <div class="step-txt">${step}</div>
              </div>
            `).join('')}
          </div>
        </div>
      </div>
    </div>
  `;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INTERACTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleChapter(chId) {
  openChapters[chId] = !openChapters[chId];
  render();
}

function toggleChapterAll(chId) {
  const ch = CHAPTERS.find(c => c.id === chId);
  const allDone = ch.sections.every(s => checkedSections[chId + '-' + s.num]);
  ch.sections.forEach(s => {
    checkedSections[chId + '-' + s.num] = !allDone;
  });
  // keep chapter open
  openChapters[chId] = true;
  render();
}

function toggleSection(key) {
  checkedSections[key] = !checkedSections[key];
  // keep open state
  render();
}

function toggleSectionDetail(key) {
  openSections[key] = !openSections[key];
  render();
}

function updateHeaderStats() {
  let total = 0, done = 0;
  CHAPTERS.forEach(ch => {
    ch.sections.forEach(s => {
      total++;
      if (checkedSections[ch.id + '-' + s.num]) done++;
    });
  });
  document.getElementById('completedCount').textContent = done;
  document.getElementById('pendingCount').textContent = total - done;
  const pct = total > 0 ? (done / total) * 100 : 0;
  document.getElementById('globalProgressBar').style.width = pct + '%';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  FILTER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentFilter = 'all';

function filterChapters(filter, btn) {
  currentFilter = filter;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  applyFilter();
}

function applyFilter() {
  document.querySelectorAll('.chapter-card').forEach(card => {
    const chId = card.id;
    const ch = CHAPTERS.find(c => c.id === chId);
    if (!ch) return;

    if (currentFilter === 'all') {
      card.style.display = '';
    } else if (currentFilter === 'done') {
      const allDone = ch.sections.every(s => checkedSections[chId + '-' + s.num]);
      card.style.display = allDone ? '' : 'none';
    } else if (currentFilter === 'pending') {
      const allDone = ch.sections.every(s => checkedSections[chId + '-' + s.num]);
      card.style.display = allDone ? 'none' : '';
    }
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SEARCH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function searchSections() {
  const q = document.getElementById('searchInput').value.toLowerCase().trim();
  document.querySelectorAll('.chapter-card').forEach(card => {
    const chId = card.id;
    const ch = CHAPTERS.find(c => c.id === chId);
    if (!ch) return;

    if (!q) { card.style.display = ''; return; }

    const chMatch = ch.title.toLowerCase().includes(q);
    const secMatch = ch.sections.some(s =>
      s.title.toLowerCase().includes(q) ||
      s.desc.toLowerCase().includes(q) ||
      s.num === q
    );

    card.style.display = (chMatch || secMatch) ? '' : 'none';
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openModal() {
  document.getElementById('modalOverlay').classList.add('show');
}

function closeModal() {
  document.getElementById('modalOverlay').classList.remove('show');
}

document.getElementById('modalOverlay').addEventListener('click', function(e) {
  if (e.target === this) closeModal();
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  RESET
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function confirmReset() {
  document.getElementById('modalTitle').textContent = 'Reset All Checkboxes';
  document.getElementById('modalDesc').textContent = 'This will clear all checked items across all 44 sections. This action cannot be undone. Are you sure?';
  document.getElementById('modalConfirmBtn').textContent = 'Yes, Reset';
  document.getElementById('modalConfirmBtn').onclick = function() {
    checkedSections = {};
    closeModal();
    render();
    // restore export button
    document.getElementById('modalConfirmBtn').textContent = 'Print / Save PDF';
    document.getElementById('modalConfirmBtn').onclick = function() { closeModal(); window.print(); };
    document.getElementById('modalTitle').textContent = 'Export Audit Report';
    document.getElementById('modalDesc').textContent = 'This will generate a printable summary of your current audit progress across all 44 sections. Open your browser\'s print dialog to save as PDF.';
  };
  document.getElementById('modalOverlay').classList.add('show');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
render();
</script>

<!-- Print styles -->
<style media="print">
  header { position: static !important; box-shadow: none !important; }
  .progress-strip { display: none; }
  .controls-bar { display: none !important; }
  .chapter-card { box-shadow: none !important; border: 1px solid #ccc; margin-bottom: 12px; }
  .chapter-body { display: block !important; }
  .chapter-card.open .chapter-body, .chapter-card .chapter-body { display: block !important; }
  .sec-detail { display: block !important; }
  .section-row.open .sec-detail, .section-row .sec-detail { display: block !important; }
  .modal-overlay { display: none !important; }
  footer { margin-top: 30px; }
  .intro-banner { background: #1a2e4a !important; }
</style>

</body>
</html>
